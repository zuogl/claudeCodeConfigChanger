#!/usr/bin/env node

const { spawn } = require('child_process');
const path = require('path');

// èŽ·å–å‚æ•°
let args = process.argv.slice(2);

// å¦‚æžœç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ 'claude'ï¼Œç§»é™¤å®ƒï¼ˆå› ä¸ºç”¨æˆ·å¯èƒ½è¿è¡Œ ccc-hot-reload claudeï¼‰
if (args.length > 0 && args[0] === 'claude') {
    args = args.slice(1);
}

// å¦‚æžœæ²¡æœ‰å‚æ•°ä¸”æ²¡æœ‰ç®¡é“è¾“å…¥ï¼Œæ˜¾ç¤ºä½¿ç”¨è¯´æ˜Ž
if (args.length === 0 && process.stdin.isTTY) {
    // ä¸æ˜¾ç¤ºå¸®åŠ©ï¼Œç›´æŽ¥å¯åŠ¨äº¤äº’å¼ claude
}

console.log('ðŸš€ å¯åŠ¨ Claude Codeï¼ˆæ”¯æŒé…ç½®çƒ­é‡è½½ï¼‰...\n');

// ä½¿ç”¨ä»£ç†è„šæœ¬
const proxyScript = path.join(__dirname, '..', 'lib', 'claude-proxy.js');

// å¯åŠ¨ä»£ç†
const proxyProcess = spawn('node', [proxyScript, ...args], {
    stdio: 'inherit'
});

proxyProcess.on('exit', (code) => {
    process.exit(code);
});

// å¤„ç†ä¸­æ–­ä¿¡å·
process.on('SIGINT', () => {
    proxyProcess.kill('SIGINT');
});

process.on('SIGTERM', () => {
    proxyProcess.kill('SIGTERM');
});